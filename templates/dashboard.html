{% extends "base.html" %}

{% block content %}
<div class="dashboard-header">
    <div class="header-main">
        <h1>Today's Overview</h1>
        <p class="date-display">{{ today_date }}</p>
    </div>
    {% if streak > 0 %}
    <div class="streak-badge">
        <span class="streak-icon">ðŸ”¥</span>
        <div class="streak-info">
            <span class="streak-count">{{ streak }} Day Streak</span>
            <span class="streak-label">Keep it going!</span>
        </div>
    </div>
    {% endif %}
</div>

<!-- Focus Mode Section -->
<div class="focus-mode-container">
    <div class="card focus-card">
        <div class="focus-header">
            <span class="focus-badge">FOCUS MODE</span>
            <div class="timer-display" id="timer">25:00</div>
        </div>
        <div class="focus-controls">
            <button id="startTimer" class="btn btn-primary">Start Focus Session</button>
            <button id="pauseTimer" class="btn btn-secondary" style="display: none;">Pause</button>
            <button id="resetTimer" class="btn btn-outline" style="display: none;">Reset</button>
        </div>
        <div id="sessionMessage" class="session-message" style="display: none;">
            Focusing... Keep your phone away!
        </div>
    </div>
</div>

<!-- Main Content Grid -->
<div class="dashboard-content" style="margin-top: 2rem;">
    <!-- Left Column: Logs -->
    <div class="card" style="height: fit-content;">
        <div style="margin-bottom: 1rem;">
            <h2>Today's Log</h2>
        </div>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Activity</th>
                        <th>Category</th>
                        <th>Time</th>
                        <th>Duration</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for activity in activities %}
                    <tr>
                        <td>{{ activity.name }}</td>
                        <td><span class="badge {{ activity.category }}">{{ activity.category|capitalize }}</span>
                        </td>
                        <td>{{ activity.start_time.strftime('%H:%M') }} - {{ activity.end_time.strftime('%H:%M') }}
                        </td>
                        <td>{{ activity.duration_minutes }} min</td>
                        <td>
                            <a href="{{ url_for('edit_entry', id=activity.id) }}" class="text-primary"
                                style="margin-right: 10px; text-decoration: none; font-size: 0.875rem;">Edit</a>
                            <a href="{{ url_for('delete_entry', id=activity.id) }}" class="text-danger"
                                onclick="return confirm('Delete this entry?')">Delete</a>
                        </td>
                    </tr>
                    {% endfor %}
                    {% if not activities %}
                    <tr>
                        <td colspan="5" class="text-center">No entries yet today.</td>
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Right Column: Stats Grid -->
    <div class="stats-grid" style="align-content: start; grid-template-columns: 1fr 1fr;">
        <div class="stat-card">
            <h3>Total Time</h3>
            <p class="stat-value">{{ (total_min / 60)|round(1) }}<span> hrs</span></p>
        </div>
        <div class="stat-card productive">
            <h3>Productive</h3>
            <p class="stat-value">{{ (productive_min / 60)|round(1) }}<span> hrs</span></p>
        </div>
        <div class="stat-card neutral">
            <h3>Neutral</h3>
            <p class="stat-value">{{ (neutral_min / 60)|round(1) }}<span> hrs</span></p>
        </div>
        <div class="stat-card waste">
            <h3>Waste</h3>
            <p class="stat-value">{{ (waste_min / 60)|round(1) }}<span> hrs</span></p>
        </div>
        <div class="stat-card score">
            <h3>Efficiency Score</h3>
            <p class="stat-value">{{ prod_percent }}<span>%</span></p>
        </div>
    </div>
</div>
{% endblock %}